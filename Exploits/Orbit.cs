using System;
using UnityEngine;
using VRC;
using VRC.SDKBase;
using Object = UnityEngine.Object;

namespace HellsingPc
{
   
    internal class ItemOrbit1
    {
        public static void ItemOrbit(Player player)
        {
            if (!ItemOrbit1.ItemOrbitToggle || VRCPlayer.field_Internal_Static_VRCPlayer_0 == null || player == null)
            {
                return;
            }
            if (ItemOrbit1.cached == null)
            {
                ItemOrbit1.Recache();
            }
            GameObject gameObject = new GameObject();
            Transform transform = gameObject.transform;
            transform.position = ((player != null) ? player.transform.position : VRCPlayer.field_Internal_Static_VRCPlayer_0.transform.position) + new Vector3(0f, (float)ItemOrbit1.ItemOrbitUpDown, 0f);
            gameObject.transform.Rotate(new Vector3(0f, 360f * Time.time * (float)ItemOrbit1.ItemOrbitSpeed, 0f));
            for (int i = 0; i < ItemOrbit1.cached.Length; i++)
            {
                VRC_Pickup vrc_Pickup = ItemOrbit1.cached[i];
                if (Networking.GetOwner(vrc_Pickup.gameObject) != Networking.LocalPlayer)
                {
                    Networking.SetOwner(Networking.LocalPlayer, vrc_Pickup.gameObject);
                }
                vrc_Pickup.transform.position = gameObject.transform.position + gameObject.transform.forward * (float)ItemOrbit1.ItemOrbitSize;
                gameObject.transform.Rotate(new Vector3(0f, (float)(360 / ItemOrbit1.cached.Length), 0f));
            }
            Object.Destroy(gameObject);
        }

      
        public static void Recache()
        {
            ItemOrbit1.cached = Object.FindObjectsOfType<VRC_Pickup>();
        }

        
        public static VRC_Pickup[] cached;

       
        public static bool ItemOrbitToggle = false;

   
        public static int ItemOrbitSpeed =  1;

     
        public static int ItemOrbitSize = 2;

      
        public static int ItemOrbitUpDown = 1;
    }
}
